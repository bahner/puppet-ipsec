# This file is managed by Puppet module ipsec. DO NOT EDIT!!!
# This file holds shared secrets or RSA private keys for authentication.

# RSA private key for this host, authenticating it to any other host
# which knows the public part.
<%
$ipsec::secrets.each |$secret| {
  case $secret['secret']['type'] {
    'RSA','ECDSA','P12': { -%>
<%= $secret['selector'] %> : <%= $secret['secret']['type'] %> <%= $secret['secret']['private_key_file'] %><%=
      $secret['secret']['prompt'] ? {
        true    => ' %prompt',
        default => $secret['secret']['passphrase'] ? {
          /.*/    => " \"${secret['secret']['passphrase']}\"",
          default => '',
        }
      } %>
<%
    } # case privkey
    'PSK','EAP','XAUTH': { -%>
<%= $secret['selector'] %> : <%= $secret['secret']['type'] %> "<%= $secret['secret']['passphrase'] %>"
<%
    } # case shared
    'PIN': { -%>
<%= $secret['selector'] %> : PIN %smartcard<%= $secret['secret']['slotnr'] -%>
<% if $secret['secret']['module'] { -%>
@<%= $secret['secret']['module'] -%>
<%}%>:<%= $secret['secret']['keyid'] %> <%=
      $secret['secret']['prompt'] ? {
        true    => '%prompt',
        default => $secret['secret']['pin'],
      } %>
<%
    } # case smartcard
  } # case
} # each loop
-%>

# this file is managed with debconf and will contain the automatically created private key
include /var/lib/strongswan/ipsec.secrets.inc
